aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_text_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
check_overlap = TRUE
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
plot.margin = margin(10, 10, 10, 100),
strip.text =  element_text(
size = 11,
family = "sans",
colour = "black"))+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_text_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
check_overlap = TRUE
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(~ Description) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
plot.margin = margin(10, 10, 10, 100),
strip.text =  element_text(
size = 11,
family = "sans",
colour = "black"))+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_text_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
check_overlap = TRUE
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(~ Description, ncol = 4) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
plot.margin = margin(10, 10, 10, 100),
strip.text =  element_text(
size = 11,
family = "sans",
colour = "black"))+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_text_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
check_overlap = TRUE
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(
~ Description,
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
plot.margin = margin(10, 10, 10, 100),
strip.text =  element_text(
size = 11,
family = "sans",
colour = "black"))+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_label_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(
~ Description,
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
plot.margin = margin(10, 10, 10, 100),
strip.text =  element_text(
size = 11,
family = "sans",
colour = "black"))+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_label_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(
~ Description,
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
plot.margin = margin(10, 10, 10, 100),
strip.background = element_blank(),
strip.text.x = element_blank()
)+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_label_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(
~ Description,
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
panel.spacing = unit(0, "lines")
plot.margin = margin(10, 10, 10, 100),
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_label_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
# geom_label_repel(
#   aes(label = gene_name),
#   size = 2,
#   force_pull = 0.1,
#   direction = "y",
#   max.overlaps = Inf,
#   position=position_quasirandom()
# )+
facet_wrap(
~ Description,
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
panel.spacing = unit(0, "lines"),
plot.margin = margin(10, 10, 10, 100),
strip.background = element_blank(),
strip.text.x = element_blank()
)+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = reorder(Description, -logFC, mean), colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_text_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
facet_wrap(
~ Description,
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
panel.spacing = unit(0, "lines"),
plot.margin = margin(10, 10, 10, 100),
strip.background = element_blank(),
strip.text.x = element_blank()
)+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
plot_kegg_scatter <- function(data, species) {
ggplot(
data,
aes(y = logFC, x = Description, colour = neg_log_pval)
)+
geom_hline(yintercept = 0, size = 0.5) +
geom_text_repel(
aes(label = gene_name),
size = 2.5,
position = position_jitter(seed = 1),
)+
geom_point(
size = 1,
alpha = 0.5,
position = position_jitter(seed = 1),
) +
facet_wrap(
~ reorder(Description, -logFC, mean),
ncol = 4,
scales = "free_x"
) +
ggtitle(
expression("Log"["2"]*" Fold Change of Insertions in Significantly Enriched KEGG Pathways During Co-culture of P. aeruginosa with Faecal Microbiome"))+
labs(y = expression("Log"["2"]*" Fold Change"),
x = "Enriched KEGG Pathway",
colour = expression("-log"["10 "]*"Adjusted p-value"))+
theme_article()+
theme(
axis.text.x = element_text(angle = 45, vjust = 1, hjust =1),
plot.title = element_text(size = 10),
panel.grid.major.y = element_line(
colour="black",
size=0.125),
panel.grid.major.x = element_line(
colour="grey",
size=0.125),
panel.spacing = unit(0, "lines"),
plot.margin = margin(10, 10, 10, 100),
strip.background = element_blank(),
strip.text.x = element_blank()
)+
scale_colour_viridis_c()
}
map(
list(PA_combined_pathways),
~ plot_kegg_scatter(.x, list("P. aeruginosa"))
)
